# Document Management Frontend (Flask)

This is the frontend web application for a document management system.  
It provides a user interface for uploading PDF files with metadata,
searching through documents, and viewing them with an embedded PDF viewer.

The frontend communicates with a separate Go backend API.
All document storage and search logic is handled by that backend.

## Features

- Upload PDF files with title, authors, year, and category.
- Search documents by text, title, or author.
- View document details and embedded PDF.
- htmx‑powered search results for a fast, dynamic UI.
- Automatically generated API documentation via Swagger UI.

## Prerequisites

- **Docker** (to build and run the container)
- A running instance of the **Go backend API**.  
  By default, the frontend expects it at `http://0.0.0.0:8080` (the service name used in a Docker Compose setup).  
  If the backend runs elsewhere, you must set the `GO_API_BASE_URL` environment variable accordingly.

## Environment Variables

| Variable           | Description                                      | Default               |
|--------------------|--------------------------------------------------|-----------------------|
| `GO_API_BASE_URL`  | Base URL of the Go backend API                   | `http://0.0.0.0:8080` |
| `UPLOAD_FOLDER`    | Directory where uploaded PDFs are stored         | `/app/uploads`        |

## Building the Docker Image

From the directory containing the `Dockerfile` and the application code, run:

```bash
docker build -t doc-frontend .
```

## Running the Container

### Basic run (with default settings)

```bash
docker run -p 5000:5000 doc-frontend
```

The application will be available at [http://localhost:5000](http://localhost:5000).

### Providing environment variables

If your Go backend runs on your host machine (e.g., at `localhost:8080`), you can use:

```bash
docker run -p 5000:5000 \
  -e GO_API_BASE_URL="http://host.docker.internal:8080" \
  doc-frontend
```

On Linux, replace `host.docker.internal` with the actual IP of your host (often `172.17.0.1`).

### Persisting uploaded files

To keep uploaded files outside the container, mount a host directory to `/app/uploads`:

```bash
docker run -p 5000:5000 \
  -v /path/on/host/uploads:/app/uploads \
  doc-frontend
```

## Accessing the Application

- **Main UI**: [http://localhost:5000](http://localhost:5000)
- **Swagger API documentation**: [http://localhost:5000/apidocs](http://localhost:5000/apidocs)  
  (Provides interactive documentation for all Flask routes, even those that return HTML.)

## Development Without Docker

1. Install Python 3.9+ and create a virtual environment.
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```
3. Set the required environment variables:
   ```bash
   export GO_API_BASE_URL="http://localhost:8080"
   export UPLOAD_FOLDER="/path/to/uploads"
   ```
4. Run the Flask development server:
   ```bash
   python app.py
   ```
   The app will be available at `http://localhost:5000`.

## Project Structure

```
.
├── app.py                 # Main Flask application
├── templates/             # HTML templates (Jinja2)
│   ├── index.html
│   ├── upload.html
│   ├── document.html
│   ├── search_results.html
│   ├── 404.html
│   └── 500.html
├── requirements.txt       # Python dependencies
├── Dockerfile             # Container definition
└── README.md              # This file
```

## Notes

- The frontend expects the Go backend to provide the following endpoints:
  - `POST /upload` – accepts a file and metadata, returns `{ "id": ... }`
  - `GET /documents/{id}` – returns document metadata
  - `GET /search?q=...&type=...` – returns search results (JSON)
- All file storage is delegated to the backend; the frontend only serves the uploaded PDFs from `UPLOAD_FOLDER` for embedding.
- The Swagger UI is generated by `flasgger` and is available at `/apidocs`.
